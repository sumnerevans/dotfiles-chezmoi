#! /bin/sh
#
# antioffice.sh
# Converts all MS Office files to PDF as soon as I download them
#
# I used this technique to run it at startup:
# https://stackoverflow.com/a/29247942/2319844
#
# File watch technique: https://unix.stackexchange.com/a/24955/168347

inotifywait -m $HOME/tmp -e create -e moved_to |
    while read path action file; do
        extension="${file##*.}"
        filename="${file%.*}"

        if [[ "$(echo "ppt pptx doc docx" | grep -w "$extension")" == 'ppt pptx doc docx' ]]; then
            libreoffice --headless --convert-to pdf "$HOME/tmp/$file" --outdir "$HOME/tmp"
            rm $HOME/tmp/$file
        fi

    done
